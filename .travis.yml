language: python
python:
- '3.5'
dist: trusty
# https://docs.travis-ci.com/user/database-setup/#PostgreSQL
addons:
  postgresql: "10"
  apt:
    packages:
    - postgresql-10
    - postgresql-client-10


# Allow the sudo command
sudo: true
env:
  matrix:
  - DJANGO_VERSION=2.0.2
  - DJANGO_SETTINGS_MODULE='better_spots.unittesting'
  global:
  - secure: hcf0CvszQD/MfcLWYIwB6PVLfa76bMwC6Bx3u0o7f+xlz04UGuEi+iJn/ugp99TABxLSBsCm5K1ZAXgYWWUfMbHE2SKlhcHI+wtY4tjybMXgnGjI7td9UTyEqOgia10UwQchf1Nei4jT8LDMsdz4bGA8Zvbphus3lk2fEhdfPSTXeUw5SQ3ggEhiEDd9Cghzz+yZ8K2oqMfz9ILmg/yDBYEQHTRDKDPWFwP+HXxAz3bdzyKvigxJc3t3LWGjZEPFGtRT6/Q4iEZ1g1H8IZXVaRVUcGOvqzRzXhB/qpIuHPIuWEtrDHqy5p9URn4bGK77oROb25L1LX5F8L6rB2AUegMDM0J1sHmC3Kbq/r+8hJe4NW/54HxbbyEBd0Ml2hiEy4D74ndfctSDPwTfJUxEXXeYGc5ll6ObUjBxKOdX0urfCRxS6AEjopPp4AdWUDEKB0uqkpWCiQmKs6YDqCodv2ZSeW64ClzRG24YYVetO2b102AOg94jaOApxSv/eWrBfI5hTB+5v280/G9zXPTkYrsF/N7lGXYktvNtk3YV+4Bohz5c+zNcm9mFePelqXP3EfaiO7lr5UrtphsDJPbpMj8UuomouCibHF38CupghlvISGFzkVgqBTZOD3gVha5zW4/UF9M2otQ3mtxa3c4Ood1ceZnFBYRs3zgbmQZVEis=
  - secure: b3ZhYAyP7XkcAJExjIunoXxuB5SNmvZPPzVsZzo+Qk9TYELN7b0o6z2m7fnnLJrJvoeDJrN9CLMbmtyEaOGi2KxvDSxo+2naPQbmndrcM8gO9/WLcZjjth9D6rpoor9Tiay3tEuJDCgNPBfMjjY6In85Y/1vBKAYtmoW517x2UTqyZjqrV0oQGavfcB1B23uPPjTvaE7j3olFfLiZyLDqoytxQVKsfNsF5Tee6CDBCjP2En39yQKUyLcHE80SMiNQMANneMSspLoLo/pEbJN3l442fx01zlPBxdewD2tR/fhaesYwaYZuetLdowA0BBeJHorYKlDqWgmASB9LL4oKYokiBvfp8t+wgnjOZhNfMv7m9P+ZxgGDbfGm69zXCWWRzO6OejCsfdd7ZhzztaeW5TbfekvYq6lCgFC/wdBRnlY4Eoi8rYjRDBssUtcRKgCQyTIN/+L+BucEvjLl0GK1GPkn9N6EFhNZWuvqMHD1ookJ413HgM03yGmHgQkGMKaHjcTdFPyjv/p5m6sNr7Lp/pNc4es/Fc9RzTldzJsV11cPwUpNcv8wV20NOeOHgfeMfJ4FTwGqERZTLuz8L9eMR4mnMU+631QPUg/3zHMNJ40z46Bcai3U0zTbB0lXIUrm/88iO2nVgaWL4jMHQaa+Zjqq3iD0dTlrfibf6YMVi4=
  - secure: YigN2LmoDN0i/+qrHeGKT1beT7+QRRyi2nxZ+QJgq0DRIuY4//xEFOKz3/9DJp1OGYJ9Eq4m6yomRnzIyNEnKqInQ4l1TEmc8CGjt6fxybHDbR+PmDPmLZHCZ+tC31KmzMdZiTDmshhmiiHpbeiHQrPlskjNKmo2DqypsHgz768PoM0i9U/6mQTAEW2u1cG87sJGvOCWAvbhVlUEZwub97Q2s8y3Y5/U0N2n3QhjfweOqnxknHt6tI+ICVP23r9S7xxiuRMC/p+tmomHwoLI5x70I2m+N11dwfzx8YWpRQ9rXmPaqgacaq4tDZVHSvquzHr9AuZD03VvKZU2rbgtLs1D3ISHHlGQwlKF0XT4U3IXKjCjTw858ADQqJwAibeeWtyr28eKX84QWRtrb7IRZdnZhzAFWVYMKx4w2PnG2MXI8mdeujVWX0AOsp9f3kh1OaOji6/1j1kf47O9fHv+SAvzHfn424soomNoM5iDCE6a8k/QgkCp8u8I1R0oAInqtt+U46HTzRmRJhgH9+OK11/FJzZ4BqLR1X3VAREEwC0gN86OeAoK5tp8Rm1IHZlXbwJxgxvp3V84Pf+gY7AjetJS9+3bssqitIH+uxFVv4i/yRwzVIPVE3KbBJJsrLM8Fwkm5RFlnGSG5ruPGZWsvdlP4IzOX0ZXiATxU28XZEo=
  - secure: fzBwT3meojJB46qM7BImjr9/j7AYyNqqLRzR2kJhFyPijKviL31rLJUHqal18fIoEBTctDNcWytporokBQLAjX2qVB7XM3Ueih7N72GqqHcYTNNRLK7gYz56nIKp24ChJXHWwyLoWqDrGovTcA4RRFRhrGV+spJ3jwZ3nlzMP3yRqML5xcjrQspTrMPys1R/8jOhG7aKGVV72PQ6MaqC50Xa3xvFpHBVc3IpX6n6n3B43JzlUXvxVVpo7s+F/kJl8m3Rh07+B59h6QYrsP3csWj1u7rh74F8+gGevpIZZVbl/maYJV7tuKmznpvvMsdTM/3dH5EPbhjRHgCXCMiulkIFPi32kqrMtrBrUdUcKovAMMHfcUz+8kNKG35iuumEmTPwvIKqWCRxEI45JB1kv4U7QlrmpgzQtdeEIKb92I/1LpP0PQV/OHty8+UHF+cqvIbXBfFeob720kIsWqSu6BmtXYu5TnE+bAg3vwu1JDKE3cymUZV1k6x3PEhxS05A+Fv7exosqTPQBlEJvYR9WIBctYBPh7M0nudHHarYZgNmYk17SiIe0OPmG7STzMRVzvl8Px3bDQfMIK8XO2PGdh+voK29yGjIqHzpubAVlrPgqB2MAC2h0J7pmKrhC3gB1q48QwFHjwixfOeNzYdbrlQIqQJhJ8jOK9BkwGQyIdc=
  - secure: Bx9dG7oUXwLQnBz0rlAPQjbL/1kLVjD9RbB97JAjq1qrHJNXB0FtEfTtMdnJngU2uXSKWfL8CmUdXK3LmXZ+MWXSDYF4OI0A/BMR/6flcKyqAKSQQni+FgtbpdN2gqyMzdHpAAG/wVe4xquyAIIyDsKSJxCHZNHfef0xOOD02w0jWhUXBI5mclWfx+y6B5Cv4oZkyoOXLRLWYxDOs61zoDrET4ceseKr0tn5Vs4SfLSAdvepx+oalTCkk0cPoS/CmE2ZRlxZr0oigN97OWIPeQKHm8Dm3jKJLgNMfccVFE89LnJArTbMrkMKLmUJzxS+PaUqpBQYVfFJ5N/ck2Yh/frMVn5IYPnM+6lhA+lS28liDPcLn9On5AzUHhKEMrwcGqGF1utqAmM7o7n/rP3XbriRhvtenTSDWfzVQh4i6WKssBbGYDOT0aKazhg0jisuqvn/LEgC5mg3uuhB/lKwolBF6e5z3QQHTXsKY2BWLEcKoXVl2O1o7yQJFbJ3Jn7nHQUHw0DkeWMvuNTnVDquwsjmojiSHkBonhFoMs8hqUyazziloRPSV1Tpt0FyafSSw7gSOCH3WITFBvmMW86PLVUjig7317AEOh8z2PVpXNJBDyvE8lMrDYNmHnKOHSbf/J9BHOsL8yozH++SBmDXlWB0UmibCQAyq56eqRQyKV8=
install:
- pip install -r requirements.txt

#before_script:
#  # ... I install the good version (PgSQL 10 Postgis 2.4)
#  - sudo apt-get install postgresql-10-postgis-2.4 -y -q
#  - psql -c 'create database better_spots;' -U postgres

before_script:
  - psql -c 'create database better_spots;' -U postgres
  - sudo apt-get install python-gdal

script:
- python manage.py migrate --noinput  --settings=better_spots.unittesting
- python manage.py test  --settings=better_spots.unittesting
