

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>facebook graph API - authentication &mdash; betterSpots 1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
        <link rel="author" title="About these documents"
              href="about.html"/>
    <link rel="top" title="betterSpots 1.0 documentation" href="index.html"/>
        <link rel="prev" title="facebook graph API - nearby" href="facebook_graph_api_nearby.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> betterSpots</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="devops.html">DevOps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="devops.html#scripts">Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="devops.html#apache">Apache</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#authentication">authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#nearby-spots-list">nearby spots list</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#spots-list">spots list</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#add-new-spot">add new spot</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#spot">spot</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#delete-spot">delete spot</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#update-spot">update spot</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#image-upload">image upload</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#favourites-spots-list">favourites spots list</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#add-spot-to-favourites">add spot to favourites</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#delete-spot-from-favourites">delete spot from favourites</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#ratings-list">ratings list</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#rate-spot">rate spot</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="google_places_api.html">Google Places API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="google_places_api.html#places-api-endpoint">places API endpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="google_places_api.html#places-nearby-search">places nearby search</a></li>
<li class="toctree-l2"><a class="reference internal" href="google_places_api.html#place-detail">place detail</a></li>
<li class="toctree-l2"><a class="reference internal" href="google_places_api.html#place-photo">place photo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="foursquare_api.html">foursquare API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="foursquare_api.html#venues-api-endpoint">venues API endpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="foursquare_api.html#categories">categories</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="facebook_graph_api_nearby.html">facebook graph API - nearby</a><ul>
<li class="toctree-l2"><a class="reference internal" href="facebook_graph_api_nearby.html#graph-api-endpoint">graph api endpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="facebook_graph_api_nearby.html#nearby-search">nearby search</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">facebook graph API - authentication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#graph-api-endpoint">graph api endpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="#get-oauth-token">get oAuth token</a></li>
<li class="toctree-l2"><a class="reference internal" href="#facebook-login-for-the-web-with-the-javascript-sdk">Facebook Login for the Web with the JavaScript SDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="#validate-token-and-userid">validate token and userID</a></li>
<li class="toctree-l2"><a class="reference internal" href="#html-js">HTML + JS</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">betterSpots</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>facebook graph API - authentication</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/facebook_graph_api_auth.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="facebook-graph-api-authentication">
<h1>facebook graph API - authentication<a class="headerlink" href="#facebook-graph-api-authentication" title="Permalink to this headline">¶</a></h1>
<div class="section" id="graph-api-endpoint">
<h2>graph api endpoint<a class="headerlink" href="#graph-api-endpoint" title="Permalink to this headline">¶</a></h2>
<dl class="get">
<dt id="get-hhttps---graph.facebook.com">
<tt class="descname">GET </tt><tt class="descname">hhttps://graph.facebook.com</tt><a class="headerlink" href="#get-hhttps---graph.facebook.com" title="Permalink to this definition">¶</a></dt>
<dd><p>applies to all method below</p>
</dd></dl>

</div>
<div class="section" id="get-oauth-token">
<h2>get oAuth token<a class="headerlink" href="#get-oauth-token" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The <cite>app-id</cite> and <cite>app-secret</cite> to be find in ap dashboard:</p>
<blockquote>
<div><a class="reference external" href="https://developers.facebook.com/apps/1553961588210538/dashboard/">https://developers.facebook.com/apps/1553961588210538/dashboard/</a></div></blockquote>
<dl class="get">
<dt id="get--oauth-access_token?client_id=app-id&amp;client_secret=app-secret&amp;grant_type=client_credentials">
<tt class="descname">GET </tt><tt class="descname">/oauth/access_token?client_id={app-id}&amp;client_secret={app-secret}&amp;grant_type=client_credentials</tt><a class="headerlink" href="#get--oauth-access_token?client_id=app-id&client_secret=app-secret&grant_type=client_credentials" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>returns:</p>
<div class="highlight-json"><div class="highlight"><pre>access_token=someLongString
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="facebook-login-for-the-web-with-the-javascript-sdk">
<h2>Facebook Login for the Web with the JavaScript SDK<a class="headerlink" href="#facebook-login-for-the-web-with-the-javascript-sdk" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p><a class="reference external" href="https://developers.facebook.com/docs/facebook-login/login-flow-for-web/v2.2">https://developers.facebook.com/docs/facebook-login/login-flow-for-web/v2.2</a></p>
<p>Facebook allows login with their JS lib.
When user sucessfully authenticated we get  accessToken, expiresIn, signedRequest, userID.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The UserID is uniqure user identifier within our facebook app.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When we push it to our backend e.g registring user, we have to make sure that data are not somehow faked, so we debug token and in response we find user_id, which should match with the UserID.</p>
</div>
</div></blockquote>
</div>
<div class="section" id="validate-token-and-userid">
<h2>validate token and userID<a class="headerlink" href="#validate-token-and-userid" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><dl class="get">
<dt id="get-graph.facebook.com-debug_token?input_token=token-to-inspect&amp;access_token=app-token-or-admin-token">
<tt class="descname">GET </tt><tt class="descname">graph.facebook.com/debug_token?input_token={token-to-inspect}&amp;access_token={app-token-or-admin-token}</tt><a class="headerlink" href="#get-graph.facebook.com-debug_token?input_token=token-to-inspect&access_token=app-token-or-admin-token" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Response:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span>
    <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;app_id&quot;</span><span class="p">:</span> <span class="s2">&quot;1553961588210538&quot;</span><span class="p">,</span>
        <span class="nt">&quot;application&quot;</span><span class="p">:</span> <span class="s2">&quot;dogspot&quot;</span><span class="p">,</span>
        <span class="nt">&quot;expires_at&quot;</span><span class="p">:</span> <span class="mi">1426543200</span><span class="p">,</span>
        <span class="nt">&quot;is_valid&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nt">&quot;scopes&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;public_profile&quot;</span><span class="p">,</span>
            <span class="s2">&quot;email&quot;</span>
        <span class="p">],</span>
        <span class="nt">&quot;user_id&quot;</span><span class="p">:</span> <span class="s2">&quot;449512258537060&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="html-js">
<h2>HTML + JS<a class="headerlink" href="#html-js" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Needed snippets for embeding Facebook JS SDK login</p>
<div class="highlight-JavaScript"><div class="highlight"><pre><span class="c1">// This is called with the results from from FB.getLoginStatus().</span>
<span class="kd">function</span> <span class="nx">statusChangeCallback</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;statusChangeCallback&#39;</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
  <span class="c1">// The response object is returned with a status field that lets the</span>
  <span class="c1">// app know the current login status of the person.</span>
  <span class="c1">// Full docs on the response object can be found in the documentation</span>
  <span class="c1">// for FB.getLoginStatus().</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="s1">&#39;connected&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Logged into your app and Facebook.</span>
    <span class="nx">testAPI</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="s1">&#39;not_authorized&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// The person is logged into Facebook, but not your app.</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">&#39;Please log &#39;</span> <span class="o">+</span>
      <span class="s1">&#39;into this app.&#39;</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// The person is not logged into Facebook, so we&#39;re not sure if</span>
    <span class="c1">// they are logged into this app or not.</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">&#39;Please log &#39;</span> <span class="o">+</span>
      <span class="s1">&#39;into Facebook.&#39;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// This function is called when someone finishes with the Login</span>
<span class="c1">// Button.  See the onlogin handler attached to it in the sample</span>
<span class="c1">// code below.</span>
<span class="kd">function</span> <span class="nx">checkLoginState</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">FB</span><span class="p">.</span><span class="nx">getLoginStatus</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">statusChangeCallback</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">fbAsyncInit</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
<span class="nx">FB</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
  <span class="nx">appId</span>      <span class="o">:</span> <span class="s1">&#39;1553961588210538&#39;</span><span class="p">,</span>
  <span class="nx">cookie</span>     <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>  <span class="c1">// enable cookies to allow the server to access</span>
                      <span class="c1">// the session</span>
  <span class="nx">xfbml</span>      <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>  <span class="c1">// parse social plugins on this page</span>
  <span class="nx">version</span>    <span class="o">:</span> <span class="s1">&#39;v2.2&#39;</span> <span class="c1">// use version 2.2</span>
<span class="p">});</span>
<span class="c1">// Now that we&#39;ve initialized the JavaScript SDK, we call</span>
<span class="c1">// FB.getLoginStatus().  This function gets the state of the</span>
<span class="c1">// person visiting this page and can return one of three states to</span>
<span class="c1">// the callback you provide.  They can be:</span>
<span class="c1">//</span>
<span class="c1">// 1. Logged into your app (&#39;connected&#39;)</span>
<span class="c1">// 2. Logged into Facebook, but not your app (&#39;not_authorized&#39;)</span>
<span class="c1">// 3. Not logged into Facebook and can&#39;t tell if they are logged into</span>
<span class="c1">//    your app or not.</span>
<span class="c1">//</span>
<span class="c1">// These three cases are handled in the callback function.</span>
<span class="nx">FB</span><span class="p">.</span><span class="nx">getLoginStatus</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">statusChangeCallback</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
<span class="p">});</span>
<span class="p">};</span>
<span class="c1">// Load the SDK asynchronously</span>
<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">js</span><span class="p">,</span> <span class="nx">fjs</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">))</span> <span class="k">return</span><span class="p">;</span>
  <span class="nx">js</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span> <span class="nx">js</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">id</span><span class="p">;</span>
  <span class="nx">js</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s2">&quot;//connect.facebook.net/en_US/sdk.js&quot;</span><span class="p">;</span>
  <span class="nx">fjs</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">js</span><span class="p">,</span> <span class="nx">fjs</span><span class="p">);</span>
<span class="p">}(</span><span class="nb">document</span><span class="p">,</span> <span class="s1">&#39;script&#39;</span><span class="p">,</span> <span class="s1">&#39;facebook-jssdk&#39;</span><span class="p">));</span>
<span class="c1">// Here we run a very simple test of the Graph API after login is</span>
<span class="c1">// successful.  See statusChangeCallback() for when this call is made.</span>
<span class="kd">function</span> <span class="nx">testAPI</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Welcome!  Fetching your information.... &#39;</span><span class="p">);</span>
  <span class="nx">FB</span><span class="p">.</span><span class="nx">api</span><span class="p">(</span><span class="s1">&#39;/me&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Successful login for: &#39;</span> <span class="o">+</span> <span class="nx">response</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span>
      <span class="s1">&#39;Thanks for logging in, &#39;</span> <span class="o">+</span> <span class="nx">response</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;!&#39;</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>needed html:</p>
<div class="highlight-HTML"><div class="highlight"><pre><span class="nt">&lt;fb:login-button</span> <span class="na">scope=</span><span class="s">&quot;public_profile,email&quot;</span> <span class="na">onlogin=</span><span class="s">&quot;checkLoginState();&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/fb:login-button&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;status&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="facebook_graph_api_nearby.html" class="btn btn-neutral" title="facebook graph API - nearby"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Andrzej Kostanski andilabs.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>